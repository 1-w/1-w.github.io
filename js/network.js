$(function(){function t(){J(),K(),y(),ctx.clearRect(0,0,canvas.width,canvas.height),M(),N(),w(),O(),setTimeout(function(){requestAnimationFrame(t)},1e3/b)}function u(a){neuron1=new A(a.clientX,a.clientY,1),g.push(neuron1),v(a),x()}function v(a){for(g[0].x=a.clientX,g[0].y=a.clientY,i=1;i<r-2;i++){if(g[0].y<s*i)return g[0].layer=i,void(p!=g[0].layer&&(p=$.extend({},g[0].layer),q=!0));g[0].layer=r-2,p!=g[0].layer&&(p=$.extend({},g[0].layer),q=!0)}}function w(){0!=g.length&&C(g[0],"grey")}function x(){for(currLayer=g[0].layer,j=0;j<k[currLayer-1].length;j++)sinapseIn=new D(currLayer-1,j,0),h.push(sinapseIn);for(l=0;l<k[currLayer+1].length;l++)sinapseOut=new D(currLayer+1,l,0),h.push(sinapseOut)}function y(){if(h.length>0)for(q&&(h.splice(0,1e3),x(),q=!1),i=0;i<h.length;i++)L=Math.max(canvas.width,canvas.height),dist=Q(k[h[i].layerID][h[i].startID],g[0]),dist>.2*L?thick=0:dist<.02*L?thick=3:thick=Math.sqrt(.2*L/Math.max(.02*L,dist)-1),h[i].thickness=thick}function z(a,b){0!=a.thickness&&(ctx.lineWidth=a.thickness,ctx.beginPath(),ctx.moveTo(k[a.layerID][a.startID].x,k[a.layerID][a.startID].y),ctx.lineTo(g[0].x,g[0].y),ctx.strokeStyle=b,ctx.stroke())}function A(a,b,c){this.x=a,this.y=b,this.goalX=0,this.goalY=0,this.connections=0,this.layer=0}function B(a){(0==a.goalX||Math.abs(a.goalX-a.x)<.1)&&(a.goalX=R(a.x-.05*canvas.width,a.x+.05*canvas.width),a.goalY=R(a.y-.05*canvas.height,a.y+.05*canvas.height)),a.x<.1&&(a.goalX=R(5,15)/100*canvas.width),a.x>canvas.width-.1&&(a.goalX=R(85,95)/100*canvas.width),a.y<.1&&(a.goalY=R(5,15)/100*canvas.height),a.y>canvas.height-.1&&(a.goalY=R(85,95)/100*canvas.height),direction_x=a.goalX-a.x,direction_y=a.goalY-a.y,a.x=a.x+.01*direction_x,a.y=a.y+.01*direction_y}function C(a,b){ctx.fillStyle=b,ctx.strokeStyle=b,ctx.lineWidth=1,ctx.beginPath(),ctx.arc(a.x,a.y,2,0,2*Math.PI,!1),ctx.closePath(),ctx.fill(),ctx.stroke()}function D(a,b,c){this.layerID=a,this.startID=b,this.endID=c,this.thickness=1}function E(a,b){0!=a.thickness&&(ctx.lineWidth=a.thickness,ctx.beginPath(),ctx.moveTo(k[a.layerID][a.startID].x,k[a.layerID][a.startID].y),ctx.lineTo(k[a.layerID+1][a.endID].x,k[a.layerID+1][a.endID].y),ctx.strokeStyle=b,ctx.stroke())}function F(){m=[];for(var a=0;a<k.length-1;a++)for(var b=0;b<k[a].length;b++)for(var c=0;c<k[a+1].length;c++)synapse1=new D(a,b,c),m.push(synapse1)}function G(a){L=Math.max(canvas.width,canvas.height),dist=Q(k[a.layerID][a.startID],k[a.layerID+1][a.endID]),dist>.2*L?thick=0:dist<.02*L?thick=3:thick=Math.sqrt(.2*L/Math.max(.02*L,dist)-1),a.thickness=thick}function J(){for(var a=0;a<k.length;a++)for(var b=0;b<k[a].length;b++)B(k[a][b])}function K(){for(var a=0;a<m.length;a++)G(m[a])}function M(){for(var a=0;a<k.length;a++)for(var b=0;b<k[a].length;b++)C(k[a][b],"black")}function N(){for(var a=0;a<m.length;a++)E(m[a],"black")}function O(){if(h.length>0)for(var a=0;a<h.length;a++)z(h[a],"grey")}function P(a,b){for(var c=0;c<k.length;c++)for(var d=0;d<k[c].length;d++)k[c][d].x=k[c][d].x*a,k[c][d].y=k[c][d].y*b,k[c][d].goalX=0,k[c][d].goalY=0}function Q(a,b){return dx=b.x-a.x,dy=b.y-a.y,dist=Math.sqrt(dx*dx+dy*dy),dist}function R(a,b){return Math.floor(Math.random()*(b-a+1)+a)}function S(a){a.style.width="100%",a.style.height="100%",a.width=a.offsetWidth,a.height=a.offsetHeight}$("#typed").typed({stringsElement:$("#typed-strings")}),canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d");var a=document.getElementById("container");addEvent(window,"resize",function(b){console.log(a.clientWidth,a.clientHeight),e=a.clientHeight/canvas.height,f=a.clientWidth/canvas.width,canvas.width=a.clientWidth,canvas.height=a.clientHeight,P(f,e)});var b=60,e=a.clientHeight/canvas.height,f=a.clientWidth/canvas.width;canvas.onmousein=function(a){u(a)},canvas.onmousemove=function(a){0==g.length?u(a):v(a)},canvas.onmouseout=function(a){g.splice(0,1),h.splice(0,1e3)},canvas.onmouseup=function(a){prevNeuron=$.extend(!0,{},g[0]),prevNeuron.goalX=prevNeuron.x+.17,prevNeuron.goalY=prevNeuron.y+.17,k[prevNeuron.layer].push(prevNeuron),F()},ctx.imageSmoothingEnabled=!0,S(canvas);var g=[],h=[],k=[[],[],[],[],[]],m=[],p=0,q=!0;LayerSize=[10,30,30,30,10];var r=k.length,s=canvas.height/(r-2);for(j=0;j<LayerSize.length;j++)for(i=0;i<LayerSize[j];i++)neuron1=$.extend(!0,{},new A((i+.5)*(1/LayerSize[j])*canvas.width,(j+.5)*(1/LayerSize.length)*canvas.height,j)),k[j].push(neuron1);F(),t()});var addEvent=function(a,b,c){null!=a&&"undefined"!=typeof a&&(a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c)};